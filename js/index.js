var res=["./img/bg-index.jpg","./img/sprites-loading.png","./img/sprites-building.png"],IndexPage=function(){this.init()};IndexPage.prototype={stopVideo:!1,init:function(){this.loading(),this.initVideo()},initVideo:function(){var i=this.video=document.getElementById("video"),n=960,t=544,o=window.innerWidth,a=window.innerHeight,e=n/t;if(a/o>e)i.height=a;else{i.width=o;var s=n*o/t,d=a-s;i.style.WebkitTransform="translate(0, "+d+"px)"}},videoStart:function(i){var n=this,t=this.video;t.play(),n.stopVideo=!1,t.ontimeupdate=function(){!n.stopVideo&&$(t).addClass("active")}},loading:function(){var i=this;new mo.Loader(res,{loadType:1,minTime:300,onLoading:function(i,n){var t=parseInt(i/n*100);$("#percent").html(t+"%")},onComplete:function(){$("#progress").addClass("cm-hide"),i.beginAnimation(),i.threeSixtyRun()}})},beginAnimation:function(){$(".loading, .loading-dialog, .loading-question, .loading-building, .loading-desc, .loading-arrow, .loading-star").addClass("transition"),this.showDialog(),this.runStar()},showDialog:function(){function i(i){return function(){setTimeout(i,1e3)}}var n=this,t=$("#dialog1"),o=$("#dialog2"),a=$("#dialog3");t.addClass("show").one("webkitTransitionEnd",i(function(){o.addClass("show"),t.removeClass("show").addClass("up").one("webkitTransitionEnd",i(function(){a.addClass("show"),o.removeClass("show").addClass("up"),t.removeClass("up").addClass("up2").one("webkitTransitionEnd",i(function(){t.removeClass("up2").addClass("out"),o.removeClass("up").addClass("out"),a.removeClass("show").addClass("out"),n.showBuilding()}))}))}))},runStar:function(){$(".loading-star").addClass("active")},showBuilding:function(){var i=this;$question=$("#question"),$building=$(".loading-building"),$building1=$("#building1"),$desc=$(".loading-desc"),$arrow=$("#arrow"),$question.addClass("active").one("webkitTransitionEnd",function(){$building.addClass("active"),$building1.one("webkitTransitionEnd",function(){$desc.addClass("active").one("webkitTransitionEnd",function(){$arrow.addClass("active"),i.bindEvents()})})})},threeSixtyRun:function(){this.threeSixty=$("#product").ThreeSixty({totalFrames:24,currentFrame:1,imgList:".threesixty_images",progress:".spinner",imagePath:"img/building/",ext:".png",height:361,width:234,navigation:!1,disableSpin:!1,onReady:function(){$(".point").each(function(){var i=$(this).data("index");$(this).addClass("point-"+i+"-1")})},onDragStop:function(i,n){var t=i%24;t=t>=0?t+1:25-Math.abs(t),$(".point").each(function(){var i=$(this).data("index");this.className="point point-"+i+" point-"+i+"-"+t})}})},bindEvents:function(){var i=this,n=this.video;$("#loading").on("swipeUp",function(){$(this).addClass("active")}),$("#btn").on("touchend",function(i){i.stopPropagation(),$(this).parent().addClass("active").one("webkitAnimationEnd",function(){$(this).removeClass("active")})}),$(".point").on("touchend",function(n){n.stopPropagation();var t=$(this).data("index");i.videoStart(t)}),n.addEventListener("ended",function(i){$(n).removeClass("active")}),$(n).on("touchend",function(t){return t.stopPropagation(),$(n).removeClass("active"),i.stopVideo=!0,this.load(),!1})}},new IndexPage;