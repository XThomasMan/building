var res=["./img/bg-index.jpg","./img/sprites-loading.png","./img/sprites-building.png","./img/sprites-index.png","./img/building/1.png","./img/building/2.png","./img/building/3.png","./img/building/4.png","./img/building/5.png","./img/building/6.png","./img/building/7.png","./img/building/8.png","./img/building/9.png","./img/building/10.png","./img/building/11.png","./img/building/12.png","./img/building/13.png","./img/building/14.png","./img/building/15.png","./img/building/16.png","./img/building/17.png","./img/building/18.png","./img/building/19.png","./img/building/20.png","./img/building/21.png","./img/building/22.png","./img/building/23.png","./img/building/24.png"],IndexPage=function(){this.init()};IndexPage.prototype={stopVideo:!1,init:function(){this.loading(),this.initVideo()},initVideo:function(){var i=this.video=document.getElementById("video"),n=960,t=544,o=window.innerWidth,e=window.innerHeight,a=n/t;if(e/o>a)i.height=e;else{i.width=o;var d=n*o/t,s=e-d;i.style.WebkitTransform="translate(0, "+s+"px)"}},videoStart:function(i){var n=this,t=this.video;t.play(),n.stopVideo=!1,t.ontimeupdate=function(){!n.stopVideo&&$(t).addClass("active")}},loading:function(){var i=this;new mo.Loader(res,{loadType:1,minTime:300,onLoading:function(i,n){var t=parseInt(i/n*100);$("#percent").html(t+"%")},onComplete:function(){$("#progress").addClass("cm-hide"),i.beginAnimation(),i.threeSixtyRun()}})},beginAnimation:function(){$(".loading, .loading-dialog, .loading-question, .loading-building, .loading-desc, .loading-arrow, .loading-star").addClass("transition"),this.showDialog(),this.runStar()},showDialog:function(){function i(i){return function(){setTimeout(i,1e3)}}var n=this,t=$("#dialog1"),o=$("#dialog2"),e=$("#dialog3");t.addClass("show").one("webkitTransitionEnd",i(function(){o.addClass("show"),t.removeClass("show").addClass("up").one("webkitTransitionEnd",i(function(){e.addClass("show"),o.removeClass("show").addClass("up"),t.removeClass("up").addClass("up2").one("webkitTransitionEnd",i(function(){t.removeClass("up2").addClass("out"),o.removeClass("up").addClass("out"),e.removeClass("show").addClass("out"),n.showBuilding()}))}))}))},runStar:function(){$(".loading-star").addClass("active")},showBuilding:function(){var i=this;$question=$("#question"),$building=$(".loading-building"),$building1=$("#building1"),$desc=$(".loading-desc"),$arrow=$("#arrow"),$question.addClass("active").one("webkitTransitionEnd",function(){$building.addClass("active"),$building1.one("webkitTransitionEnd",function(){$desc.addClass("active").one("webkitTransitionEnd",function(){$arrow.addClass("active"),i.bindEvents()})})})},setPoint:function(i){$(".point").each(function(){var n=$(this).data("index");this.className="point point-"+n+(i?" point-"+n+"-"+i:"")})},threeSixtyRun:function(){var i=this,n=0;window.threeSixty=$("#product").ThreeSixty({totalFrames:24,currentFrame:1,imgList:".threesixty_images",progress:".spinner",imagePath:"img/building/",ext:".png",height:361,width:234,speed:.01,direction:0,navigation:!1,disableSpin:!1,onReady:function(){i.setPoint(1)},onDragStart:function(i){n=i},onDragMove:function(n){i.setPoint()},onDragStop:function(t,o){var e=t%24,a=o.target,d=a.className,s=n===t;if(e=e>=0?e+1:25-Math.abs(e),i.setPoint(e),d.indexOf("point")>-1&&s){var g=$(a).data("index");i.videoStart(g)}}})},bindEvents:function(){var i=this,n=this.video;$("#loading").on("swipeUp",function(){$(this).addClass("active")}),$("#btn").on("touchend",function(i){i.stopPropagation(),$(this).parent().addClass("active").one("webkitAnimationEnd",function(){$(this).removeClass("active")})}),n.addEventListener("ended",function(i){$(n).removeClass("active")}),$(n).on("touchend",function(t){return t.stopPropagation(),$(n).removeClass("active"),i.stopVideo=!0,this.load(),!1})}},new IndexPage;